{"version":3,"file":"debug.mjs","sources":["../src/check-props.js","../src/component-stack.js","../../compat/src/util.js","../src/debug.js","../../src/constants.js","../src/constants.js","../src/index.js"],"sourcesContent":["const ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nlet loggedTypeFailures = {};\n\n/**\n * Reset the history of which prop type warnings have been logged.\n */\nexport function resetPropWarnings() {\n\tloggedTypeFailures = {};\n}\n\n/**\n * Assert that the values match with the type specs.\n * Error messages are memorized and will only be shown once.\n *\n * Adapted from https://github.com/facebook/prop-types/blob/master/checkPropTypes.js\n *\n * @param {object} typeSpecs Map of name to a ReactPropType\n * @param {object} values Runtime values that need to be type-checked\n * @param {string} location e.g. \"prop\", \"context\", \"child context\"\n * @param {string} componentName Name of the component for error messages.\n * @param {?Function} getStack Returns the component stack.\n */\nexport function checkPropTypes(\n\ttypeSpecs,\n\tvalues,\n\tlocation,\n\tcomponentName,\n\tgetStack\n) {\n\tObject.keys(typeSpecs).forEach(typeSpecName => {\n\t\tlet error;\n\t\ttry {\n\t\t\terror = typeSpecs[typeSpecName](\n\t\t\t\tvalues,\n\t\t\t\ttypeSpecName,\n\t\t\t\tcomponentName,\n\t\t\t\tlocation,\n\t\t\t\tnull,\n\t\t\t\tReactPropTypesSecret\n\t\t\t);\n\t\t} catch (e) {\n\t\t\terror = e;\n\t\t}\n\t\tif (error && !(error.message in loggedTypeFailures)) {\n\t\t\tloggedTypeFailures[error.message] = true;\n\t\t\tconsole.error(\n\t\t\t\t`Failed ${location} type: ${error.message}${(getStack &&\n\t\t\t\t\t`\\n${getStack()}`) ||\n\t\t\t\t\t''}`\n\t\t\t);\n\t\t}\n\t});\n}\n","import { options, Fragment } from 'preact';\n\n/**\n * Get human readable name of the component/dom node\n * @param {import('./internal').VNode} vnode\n * @param {import('./internal').VNode} vnode\n * @returns {string}\n */\nexport function getDisplayName(vnode) {\n\tif (vnode.type === Fragment) {\n\t\treturn 'Fragment';\n\t} else if (typeof vnode.type == 'function') {\n\t\treturn vnode.type.displayName || vnode.type.name;\n\t} else if (typeof vnode.type == 'string') {\n\t\treturn vnode.type;\n\t}\n\n\treturn '#text';\n}\n\n/**\n * Used to keep track of the currently rendered `vnode` and print it\n * in debug messages.\n */\nlet renderStack = [];\n\n/**\n * Keep track of the current owners. An owner describes a component\n * which was responsible to render a specific `vnode`. This exclude\n * children that are passed via `props.children`, because they belong\n * to the parent owner.\n *\n * ```jsx\n * const Foo = props => <div>{props.children}</div> // div's owner is Foo\n * const Bar = props => {\n *   return (\n *     <Foo><span /></Foo> // Foo's owner is Bar, span's owner is Bar\n *   )\n * }\n * ```\n *\n * Note: A `vnode` may be hoisted to the root scope due to compiler\n * optimiztions. In these cases the `_owner` will be different.\n */\nlet ownerStack = [];\n\n/**\n * Get the currently rendered instance\n * @returns {import('./internal').Internal | null}\n */\nexport function getCurrentInternal() {\n\treturn renderStack.length > 0 ? renderStack[renderStack.length - 1] : null;\n}\n\n/**\n * If the user doesn't have `@babel/plugin-transform-react-jsx-source`\n * somewhere in his tool chain we can't print the filename and source\n * location of a component. In that case we just omit that, but we'll\n * print a helpful message to the console, notifying the user of it.\n */\nlet hasBabelPlugin = false;\n\n/**\n * Check if a `vnode` is a possible owner.\n * @param {import('./internal').Internal} internal\n */\nfunction isPossibleOwner(internal) {\n\treturn typeof internal.type == 'function' && internal.type != Fragment;\n}\n\n/**\n * Return the component stack that was captured up to this point.\n * @param {import('./internal').Internal} internal\n * @returns {string}\n */\nexport function getOwnerStack(internal) {\n\tconst stack = [internal];\n\tlet next = internal;\n\twhile (next._owner != null) {\n\t\tstack.push(next._owner);\n\t\tnext = next._owner;\n\t}\n\n\treturn stack.reduce((acc, owner) => {\n\t\tacc += `  in ${getDisplayName(owner)}`;\n\n\t\tconst source = owner.props && owner.props.__source;\n\t\tif (source) {\n\t\t\tacc += ` (at ${source.fileName}:${source.lineNumber})`;\n\t\t} else if (!hasBabelPlugin) {\n\t\t\thasBabelPlugin = true;\n\t\t\tconsole.warn(\n\t\t\t\t'Add @babel/plugin-transform-react-jsx-source to get a more detailed component stack. Note that you should not add it to production builds of your App for bundle size reasons.'\n\t\t\t);\n\t\t}\n\n\t\treturn (acc += '\\n');\n\t}, '');\n}\n\n/**\n * Setup code to capture the component trace while rendering. Note that\n * we cannot simply traverse `vnode._parent` upwards, because we have some\n * debug messages for `this.setState` where the `vnode` is `undefined`.\n */\nexport function setupComponentStack() {\n\tlet oldDiff = options._diff;\n\tlet oldDiffed = options.diffed;\n\tlet oldRoot = options._root;\n\tlet oldVNode = options.vnode;\n\tlet oldInternal = options._internal;\n\tlet oldRender = options._render;\n\n\toptions.diffed = internal => {\n\t\tif (isPossibleOwner(internal)) {\n\t\t\townerStack.pop();\n\t\t}\n\t\trenderStack.pop();\n\t\tif (oldDiffed) oldDiffed(internal);\n\t};\n\n\toptions._diff = (internal, vnode) => {\n\t\tif (isPossibleOwner(internal)) {\n\t\t\trenderStack.push(internal);\n\t\t}\n\t\tif (oldDiff) oldDiff(internal, vnode);\n\t};\n\n\toptions._root = (vnode, parent) => {\n\t\townerStack = [];\n\t\tif (oldRoot) oldRoot(vnode, parent);\n\t};\n\n\toptions.vnode = vnode => {\n\t\tvnode._owner =\n\t\t\townerStack.length > 0 ? ownerStack[ownerStack.length - 1] : null;\n\t\tif (oldVNode) oldVNode(vnode);\n\t};\n\n\toptions._internal = (internal, vnode) => {\n\t\tif (internal.type !== null) {\n\t\t\tinternal._owner = vnode._owner;\n\t\t}\n\t\tif (oldInternal) oldInternal(internal, vnode);\n\t};\n\n\toptions._render = vnode => {\n\t\tif (isPossibleOwner(vnode)) {\n\t\t\townerStack.push(vnode);\n\t\t}\n\n\t\tif (oldRender) oldRender(vnode);\n\t};\n}\n","export const IS_NON_DIMENSIONAL = /^(-|f[lo].*[^se]$|g.{5,}[^ps]$|z|o[pr]|(W.{5})?[lL]i.*(t|mp)$|an|(bo|s).{4}Im|sca|m.{6}[ds]|ta|c.*[st]$|wido|ini)/;\n\n/**\n * Check if two objects have a different shape\n * @param {object} a\n * @param {object} b\n * @returns {boolean}\n */\nexport function shallowDiffers(a, b) {\n\tfor (let i in a) if (i !== '__source' && !(i in b)) return true;\n\tfor (let i in b) if (i !== '__source' && a[i] !== b[i]) return true;\n\treturn false;\n}\n","import { checkPropTypes } from './check-props';\nimport { options, Component } from 'preact';\nimport {\n\tELEMENT_NODE,\n\tDOCUMENT_NODE,\n\tDOCUMENT_FRAGMENT_NODE\n} from './constants';\nimport {\n\tgetOwnerStack,\n\tsetupComponentStack,\n\tgetCurrentInternal,\n\tgetDisplayName\n} from './component-stack';\n// these constants get inlined at build time:\nimport { MODE_UNMOUNTING } from '../../src/constants';\nimport { IS_NON_DIMENSIONAL } from '../../compat/src/util';\n\nconst isWeakMapSupported = typeof WeakMap == 'function';\n\nfunction getClosestDomNodeParent(parent) {\n\tif (!parent) return {};\n\tif (typeof parent.type == 'function') {\n\t\treturn getClosestDomNodeParent(parent._parent);\n\t}\n\treturn parent;\n}\n\nexport function initDebug() {\n\tsetupComponentStack();\n\n\tlet hooksAllowed = false;\n\n\t/* eslint-disable no-console */\n\tlet oldBeforeDiff = options._diff;\n\tlet oldDiffed = options.diffed;\n\tlet oldVnode = options.vnode;\n\tlet oldCatchError = options._catchError;\n\tlet oldRoot = options._root;\n\tlet oldHook = options._hook;\n\tconst warnedComponents = !isWeakMapSupported\n\t\t? null\n\t\t: {\n\t\t\t\tuseEffect: new WeakMap(),\n\t\t\t\tuseLayoutEffect: new WeakMap(),\n\t\t\t\tlazyPropTypes: new WeakMap()\n\t\t  };\n\tconst deprecations = [];\n\n\toptions._catchError = (error, vnode, oldVNode) => {\n\t\tlet component = vnode && vnode._component;\n\t\tif (component && typeof error.then == 'function') {\n\t\t\tconst promise = error;\n\t\t\terror = new Error(\n\t\t\t\t`Missing Suspense. The throwing component was: ${getDisplayName(vnode)}`\n\t\t\t);\n\n\t\t\tlet parent = vnode;\n\t\t\tfor (; parent; parent = parent._parent) {\n\t\t\t\tif (parent._component && parent._component._childDidSuspend) {\n\t\t\t\t\terror = promise;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// We haven't recovered and we know at this point that there is no\n\t\t\t// Suspense component higher up in the tree\n\t\t\tif (error instanceof Error) {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\toldCatchError(error, vnode, oldVNode);\n\n\t\t\t// when an error was handled by an ErrorBoundary we will nontheless emit an error\n\t\t\t// event on the window object. This is to make up for react compatibility in dev mode\n\t\t\t// and thus make the Next.js dev overlay work.\n\t\t\tif (typeof error.then != 'function') {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthrow error;\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tthrow e;\n\t\t}\n\t};\n\n\toptions._root = (vnode, parentNode) => {\n\t\tif (!parentNode) {\n\t\t\tthrow new Error(\n\t\t\t\t'Undefined parent passed to render(), this is the second argument.\\n' +\n\t\t\t\t\t'Check if the element is available in the DOM/has the correct id.'\n\t\t\t);\n\t\t}\n\n\t\tlet isValid;\n\t\tswitch (parentNode.nodeType) {\n\t\t\tcase ELEMENT_NODE:\n\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\tcase DOCUMENT_NODE:\n\t\t\t\tisValid = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tisValid = false;\n\t\t}\n\n\t\tif (!isValid) {\n\t\t\tlet componentName = getDisplayName(vnode);\n\t\t\tthrow new Error(\n\t\t\t\t`Expected a valid HTML node as a second argument to render.\tReceived ${parentNode} instead: render(<${componentName} />, ${parentNode});`\n\t\t\t);\n\t\t}\n\n\t\tif (oldRoot) oldRoot(vnode, parentNode);\n\t};\n\n\toptions._diff = (internal, vnode) => {\n\t\tif (vnode === null || typeof vnode !== 'object') return;\n\t\t// Check if the user passed plain objects as children. Note that we cannot\n\t\t// move this check into `options.vnode` because components can receive\n\t\t// children in any shape they want (e.g.\n\t\t// `<MyJSONFormatter>{{ foo: 123, bar: \"abc\" }}</MyJSONFormatter>`).\n\t\tif (vnode.constructor !== undefined) {\n\t\t\tconst keys = Object.keys(vnode).join(',');\n\t\t\tthrow new Error(\n\t\t\t\t`Objects are not valid as a child. Encountered an object with the keys {${keys}}.` +\n\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t);\n\t\t}\n\n\t\tlet { type, _parent: parent } = internal;\n\n\t\tif (type === undefined) {\n\t\t\tthrow new Error(\n\t\t\t\t'Undefined component passed to createElement()\\n\\n' +\n\t\t\t\t\t'You likely forgot to export your component or might have mixed up default and named imports' +\n\t\t\t\t\tserializeVNode(vnode) +\n\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t);\n\t\t} else if (type != null && typeof type == 'object') {\n\t\t\tif (type.constructor === undefined) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`Invalid type passed to createElement(): ${type}\\n\\n` +\n\t\t\t\t\t\t'Did you accidentally pass a JSX literal as JSX twice?\\n\\n' +\n\t\t\t\t\t\t`  let My${getDisplayName(internal)} = ${serializeVNode(type)};\\n` +\n\t\t\t\t\t\t`  let vnode = <My${getDisplayName(internal)} />;\\n\\n` +\n\t\t\t\t\t\t'This usually happens when you export a JSX literal and not the component.' +\n\t\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthrow new Error(\n\t\t\t\t'Invalid type passed to createElement(): ' +\n\t\t\t\t\t(Array.isArray(type) ? 'array' : type)\n\t\t\t);\n\t\t}\n\n\t\tlet parentVNode = getClosestDomNodeParent(parent);\n\n\t\thooksAllowed = true;\n\n\t\tif (\n\t\t\t(type === 'thead' || type === 'tfoot' || type === 'tbody') &&\n\t\t\tparentVNode.type !== 'table'\n\t\t) {\n\t\t\tconsole.error(\n\t\t\t\t'Improper nesting of table. Your <thead/tbody/tfoot> should have a <table> parent.' +\n\t\t\t\t\tserializeVNode(internal) +\n\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t);\n\t\t} else if (\n\t\t\ttype === 'tr' &&\n\t\t\tparentVNode.type !== 'thead' &&\n\t\t\tparentVNode.type !== 'tfoot' &&\n\t\t\tparentVNode.type !== 'tbody' &&\n\t\t\tparentVNode.type !== 'table'\n\t\t) {\n\t\t\tconsole.error(\n\t\t\t\t'Improper nesting of table. Your <tr> should have a <thead/tbody/tfoot/table> parent.' +\n\t\t\t\t\tserializeVNode(internal) +\n\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t);\n\t\t} else if (type === 'td' && parentVNode.type !== 'tr') {\n\t\t\tconsole.error(\n\t\t\t\t'Improper nesting of table. Your <td> should have a <tr> parent.' +\n\t\t\t\t\tserializeVNode(internal) +\n\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t);\n\t\t} else if (type === 'th' && parentVNode.type !== 'tr') {\n\t\t\tconsole.error(\n\t\t\t\t'Improper nesting of table. Your <th> should have a <tr>.' +\n\t\t\t\t\tserializeVNode(internal) +\n\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t);\n\t\t}\n\t\tlet isCompatNode = '$$typeof' in vnode;\n\t\tif (\n\t\t\tinternal.ref !== undefined &&\n\t\t\ttypeof internal.ref != 'function' &&\n\t\t\ttypeof internal.ref != 'object' &&\n\t\t\t!isCompatNode // allow string refs when preact-compat is installed\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t`Component's \"ref\" property should be a function, or an object created ` +\n\t\t\t\t\t`by createRef(), but got [${typeof internal.ref}] instead\\n` +\n\t\t\t\t\tserializeVNode(internal) +\n\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t);\n\t\t}\n\n\t\tif (typeof internal.type == 'string') {\n\t\t\tfor (const key in vnode.props) {\n\t\t\t\tif (\n\t\t\t\t\tkey[0] === 'o' &&\n\t\t\t\t\tkey[1] === 'n' &&\n\t\t\t\t\ttypeof vnode.props[key] != 'function' &&\n\t\t\t\t\tvnode.props[key] != null\n\t\t\t\t) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t`Component's \"${key}\" property should be a function, ` +\n\t\t\t\t\t\t\t`but got [${typeof vnode.props[key]}] instead\\n` +\n\t\t\t\t\t\t\tserializeVNode(vnode) +\n\t\t\t\t\t\t\t`\\n\\n${getOwnerStack(internal)}`\n\t\t\t\t\t);\n\t\t\t\t} else if (\n\t\t\t\t\t!isCompatNode &&\n\t\t\t\t\tkey === 'style' &&\n\t\t\t\t\tvnode.props[key] !== null &&\n\t\t\t\t\ttypeof vnode.props[key] === 'object'\n\t\t\t\t) {\n\t\t\t\t\tconst style = vnode.props[key];\n\t\t\t\t\tfor (let i in style) {\n\t\t\t\t\t\tif (typeof style[i] === 'number' && !IS_NON_DIMENSIONAL.test(i)) {\n\t\t\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\t\t`Numeric CSS property value is missing a \"px\" unit: ${i}: ${style[i]}\"\\n` +\n\t\t\t\t\t\t\t\t\tserializeVNode(vnode) +\n\t\t\t\t\t\t\t\t\t`\\n\\n${getOwnerStack(vnode)}`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check prop-types if available\n\t\tif (typeof internal.type == 'function' && internal.type.propTypes) {\n\t\t\tif (\n\t\t\t\tinternal.type.displayName === 'Lazy' &&\n\t\t\t\twarnedComponents &&\n\t\t\t\t!warnedComponents.lazyPropTypes.has(internal.type)\n\t\t\t) {\n\t\t\t\tconst m =\n\t\t\t\t\t'PropTypes are not supported on lazy(). Use propTypes on the wrapped component itself. ';\n\t\t\t\ttry {\n\t\t\t\t\tconst lazyVNode = internal.type();\n\t\t\t\t\twarnedComponents.lazyPropTypes.set(internal.type, true);\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\tm + `Component wrapped in lazy() is ${getDisplayName(lazyVNode)}`\n\t\t\t\t\t);\n\t\t\t\t} catch (promise) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\tm + \"We will log the wrapped component's name once it is loaded.\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If vnode is not present we're mounting\n\t\t\tlet values = vnode ? vnode.props : internal.props;\n\t\t\tif (internal.type._forwarded) {\n\t\t\t\tvalues = Object.assign({}, values);\n\t\t\t\tdelete values.ref;\n\t\t\t}\n\n\t\t\tcheckPropTypes(\n\t\t\t\tinternal.type.propTypes,\n\t\t\t\tvalues,\n\t\t\t\t'prop',\n\t\t\t\tgetDisplayName(internal),\n\t\t\t\t() => getOwnerStack(internal)\n\t\t\t);\n\t\t}\n\n\t\tif (oldBeforeDiff) oldBeforeDiff(internal, vnode);\n\t};\n\n\toptions._hook = (internal, index, type) => {\n\t\tif (!internal || !hooksAllowed) {\n\t\t\tthrow new Error('Hook can only be invoked from render methods.');\n\t\t}\n\n\t\tif (oldHook) oldHook(internal, index, type);\n\t};\n\n\t// Ideally we'd want to print a warning once per component, but we\n\t// don't have access to the vnode that triggered it here. As a\n\t// compromise and to avoid flooding the console with warnings we\n\t// print each deprecation warning only once.\n\tconst warn = (property, message) => ({\n\t\tget() {\n\t\t\tconst key = 'get' + property + message;\n\t\t\tif (deprecations && deprecations.indexOf(key) < 0) {\n\t\t\t\tdeprecations.push(key);\n\t\t\t\tconsole.warn(`getting vnode.${property} is deprecated, ${message}`);\n\t\t\t}\n\t\t},\n\t\tset() {\n\t\t\tconst key = 'set' + property + message;\n\t\t\tif (deprecations && deprecations.indexOf(key) < 0) {\n\t\t\t\tdeprecations.push(key);\n\t\t\t\tconsole.warn(`setting vnode.${property} is not allowed, ${message}`);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst deprecatedAttributes = {\n\t\tnodeName: warn('nodeName', 'use vnode.type'),\n\t\tattributes: warn('attributes', 'use vnode.props'),\n\t\tchildren: warn('children', 'use vnode.props.children')\n\t};\n\n\t// Property descriptor: preserve a property's value but make it non-enumerable:\n\tconst debugProps = {\n\t\t__source: { enumerable: false },\n\t\t__self: { enumerable: false }\n\t};\n\n\t// If it's acceptable to inject debug properties onto the\n\t// prototype, __proto__ is faster than defineProperties():\n\t// https://esbench.com/bench/6021ebd7d9c27600a7bfdba3\n\tconst deprecatedProto = Object.create({}, deprecatedAttributes);\n\n\toptions.vnode = vnode => {\n\t\tconst props = vnode.props;\n\t\tif (props != null && ('__source' in props || '__self' in props)) {\n\t\t\tObject.defineProperties(props, debugProps);\n\t\t\tvnode.__source = props.__source;\n\t\t\tvnode.__self = props.__self;\n\t\t}\n\n\t\t// eslint-disable-next-line\n\t\tvnode.__proto__ = deprecatedProto;\n\t\tif (oldVnode) oldVnode(vnode);\n\t};\n\n\toptions.diffed = vnode => {\n\t\thooksAllowed = false;\n\n\t\tif (oldDiffed) oldDiffed(vnode);\n\n\t\tif (vnode._children != null) {\n\t\t\tconst keys = [];\n\t\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\t\tconst child = vnode._children[i];\n\t\t\t\tif (!child || child.key == null) continue;\n\n\t\t\t\tconst key = child.key;\n\t\t\t\tif (keys.indexOf(key) !== -1) {\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t'Following component has two or more children with the ' +\n\t\t\t\t\t\t\t`same key attribute: \"${key}\". This may cause glitches and misbehavior ` +\n\t\t\t\t\t\t\t'in rendering process. Component: \\n\\n' +\n\t\t\t\t\t\t\tserializeVNode(vnode) +\n\t\t\t\t\t\t\t`\\n\\n${getOwnerStack(vnode)}`\n\t\t\t\t\t);\n\n\t\t\t\t\t// Break early to not spam the console\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tkeys.push(key);\n\t\t\t}\n\t\t}\n\t};\n}\n\nconst setState = Component.prototype.setState;\n\n/** @this {import('../../src/internal').Component} */\nComponent.prototype.setState = function(update, callback) {\n\tif (this._internal == null) {\n\t\t// `this._internal` will be `null` during componentWillMount. But it\n\t\t// is perfectly valid to call `setState` during cWM. So we\n\t\t// need an additional check to verify that we are dealing with a\n\t\t// call inside constructor.\n\t\tif (this.state == null) {\n\t\t\tconsole.warn(\n\t\t\t\t`Calling \"this.setState\" inside the constructor of a component is a ` +\n\t\t\t\t\t`no-op and might be a bug in your application. Instead, set ` +\n\t\t\t\t\t`\"this.state = {}\" directly.\\n\\n${getOwnerStack(\n\t\t\t\t\t\tgetCurrentInternal()\n\t\t\t\t\t)}`\n\t\t\t);\n\t\t}\n\t}\n\n\treturn setState.call(this, update, callback);\n};\n\nconst forceUpdate = Component.prototype.forceUpdate;\n\n/** @this {import('../../src/internal').Component} */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._internal == null) {\n\t\tconsole.warn(\n\t\t\t`Calling \"this.forceUpdate\" inside the constructor of a component is a ` +\n\t\t\t\t`no-op and might be a bug in your application.\\n\\n${getOwnerStack(\n\t\t\t\t\tgetCurrentInternal()\n\t\t\t\t)}`\n\t\t);\n\t} else if (this._internal.flags & MODE_UNMOUNTING) {\n\t\tconsole.warn(\n\t\t\t`Can't call \"this.forceUpdate\" on an unmounted component. This is a no-op, ` +\n\t\t\t\t`but it indicates a memory leak in your application. To fix, cancel all ` +\n\t\t\t\t`subscriptions and asynchronous tasks in the componentWillUnmount method.` +\n\t\t\t\t`\\n\\n${getOwnerStack(this._internal)}`\n\t\t);\n\t}\n\treturn forceUpdate.call(this, callback);\n};\n\n/**\n * Serialize a vnode tree to a string\n * @param {import('./internal').VNode} vnode\n * @returns {string}\n */\nexport function serializeVNode(vnode) {\n\tlet { props } = vnode;\n\tlet name = getDisplayName(vnode);\n\n\tlet attrs = '';\n\tfor (let prop in props) {\n\t\tif (props.hasOwnProperty(prop) && prop !== 'children') {\n\t\t\tlet value = props[prop];\n\n\t\t\t// If it is an object but doesn't have toString(), use Object.toString\n\t\t\tif (typeof value == 'function') {\n\t\t\t\tvalue = `function ${value.displayName || value.name}() {}`;\n\t\t\t}\n\n\t\t\tvalue =\n\t\t\t\tObject(value) === value && !value.toString\n\t\t\t\t\t? Object.prototype.toString.call(value)\n\t\t\t\t\t: value + '';\n\n\t\t\tattrs += ` ${prop}=${JSON.stringify(value)}`;\n\t\t}\n\t}\n\n\tlet children = props.children;\n\treturn `<${name}${attrs}${\n\t\tchildren && children.length ? '>..</' + name + '>' : ' />'\n\t}`;\n}\n","// Internal.flags bitfield constants\nexport const TYPE_TEXT = 1 << 0;\nexport const TYPE_ELEMENT = 1 << 1;\nexport const TYPE_CLASS = 1 << 2;\nexport const TYPE_FUNCTION = 1 << 3;\n/** Signals this internal has a _parentDom prop that should change the parent\n * DOM node of it's children */\nexport const TYPE_ROOT = 1 << 4;\n\n/** Any type of internal representing DOM */\nexport const TYPE_DOM = TYPE_TEXT | TYPE_ELEMENT;\n/** Any type of component */\nexport const TYPE_COMPONENT = TYPE_CLASS | TYPE_FUNCTION | TYPE_ROOT;\n\n// Modes of rendering\n/** Normal hydration that attaches to a DOM tree but does not diff it. */\nexport const MODE_HYDRATE = 1 << 5;\n/** Top level render unspecified behaviour (old replaceNode parameter to render) */\nexport const MODE_MUTATIVE_HYDRATE = 1 << 6;\n/** Signifies this VNode suspended on the previous render */\nexport const MODE_SUSPENDED = 1 << 7;\n/** Signifies this VNode errored on the previous render */\nexport const MODE_ERRORED = 1 << 8;\n/** Signifies an error has been thrown and this component will be attempting to\n * handle & rerender the error on next render. In other words, on the next\n * render of this component, unset this mode and set the MODE_RERENDERING_ERROR.\n * This flag is distinct from MODE_RERENDERING_ERROR so that a component can\n * catch multiple errors thrown by its children in one render pass (see test\n * \"should handle double child throws\").\n */\nexport const MODE_PENDING_ERROR = 1 << 9;\n/** Signifies this Internal is attempting to \"handle\" an error and is\n * rerendering. This mode tracks that a component's last rerender was trying to\n * handle an error. As such, if another error is thrown while a component has\n * this flag set, it should not handle the newly thrown error since it failed to\n * successfully rerender the original error. This prevents error handling\n * infinite render loops */\nexport const MODE_RERENDERING_ERROR = 1 << 10;\n/** Signals this internal has been unmounted */\nexport const MODE_UNMOUNTING = 1 << 11;\n/** This Internal is rendered in an SVG tree */\nexport const MODE_SVG = 1 << 12;\n\n/** Signifies that bailout checks will be bypassed */\nexport const FORCE_UPDATE = 1 << 13;\n/** Signifies that a node needs to be updated */\nexport const DIRTY_BIT = 1 << 14;\n/** Signals the component can skip children due to a non-update */\nexport const SKIP_CHILDREN = 1 << 15;\n\n/** Reset all mode flags */\nexport const RESET_MODE = ~(\n\tMODE_HYDRATE |\n\tMODE_MUTATIVE_HYDRATE |\n\tMODE_SUSPENDED |\n\tMODE_ERRORED |\n\tMODE_RERENDERING_ERROR |\n\tFORCE_UPDATE |\n\tSKIP_CHILDREN\n);\n\n/** Modes a child internal inherits from their parent */\nexport const INHERITED_MODES = MODE_HYDRATE | MODE_MUTATIVE_HYDRATE | MODE_SVG;\n\nexport const EMPTY_ARR = [];\nexport const UNDEFINED = undefined;\n","export const ELEMENT_NODE = 1;\nexport const DOCUMENT_NODE = 9;\nexport const DOCUMENT_FRAGMENT_NODE = 11;\n","import { initDebug } from './debug';\nimport 'preact/devtools';\n\ninitDebug();\n\nexport { resetPropWarnings } from './check-props';\n"],"names":["loggedTypeFailures","resetPropWarnings","getDisplayName","vnode","type","Fragment","displayName","name","renderStack","ownerStack","getCurrentInternal","length","hasBabelPlugin","isPossibleOwner","internal","getOwnerStack","stack","next","push","reduce","acc","owner","source","props","__source","fileName","lineNumber","console","warn","IS_NON_DIMENSIONAL","isWeakMapSupported","WeakMap","getClosestDomNodeParent","parent","setState","Component","prototype","update","callback","this","state","call","forceUpdate","serializeVNode","attrs","prop","hasOwnProperty","value","Object","toString","JSON","stringify","children","flags","oldDiff","options","oldDiffed","diffed","oldRoot","oldVNode","oldInternal","oldRender","pop","setupComponentStack","hooksAllowed","oldBeforeDiff","oldVnode","oldCatchError","oldHook","warnedComponents","useEffect","useLayoutEffect","lazyPropTypes","deprecations","error","then","promise","Error","setTimeout","e","parentNode","isValid","nodeType","componentName","undefined","constructor","keys","join","__","Array","isArray","parentVNode","isCompatNode","ref","key","style","i","test","propTypes","has","m","lazyVNode","set","values","assign","typeSpecs","location","getStack","forEach","typeSpecName","message","checkPropTypes","index","property","get","indexOf","deprecatedAttributes","nodeName","attributes","debugProps","enumerable","__self","deprecatedProto","create","defineProperties","__proto__","child","initDebug"],"mappings":"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"}